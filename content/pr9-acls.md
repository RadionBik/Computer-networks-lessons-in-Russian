pr9-acls

# Практическая работа №9. Access Lists \(ACLs\)

Цель: разобрать назначение и основные принципы конфигурации Access Lists \(ACL\) в Packet Tracer.

ACLs \(списки доступа\) определяют политику доступа в сети. Они необходимы для контроля трафика в сети путём фильтрации пакетов, которые не соответствуют сетевой политике. ACLs работают на 3-м и 4-м уровнях OSI, следовательно, трафик анализируется по IP-адресам и TCP/UDP портам. ACL классифицируются на:

* Входящие \(inbound ACLs\) – входящие пакеты фильтруются ДО того, как они маршрутизируются на иной интерфейс. Эффективно, но применимо только если сеть, которая подключена ко входному интерфейсу, является единственным источником пакетов для фильтрации.

* Исходящие \(outbound ACLs\) – пакеты фильтруются ПОСЛЕ маршрутизации на выходной интерфейс. Подходят для тех случаев, когда есть нужда фильтровать пакеты приходящие из различных входных интерфейсов.

Различают также стандартные \(диапазон номеров 1-99, 1300-1999\) и расширенные \(100-199, 2000-2699\) типы списков. Первые работают только по IP-адресам источников, когда вторые распознают также номера портов, опции протоколов и могут быть применены как к источникам, так и к получателям.

Конфигурация ACLs может быть сложной задачей, т.к. их количество может быть значительным. На каждый интерфейс, для каждого направления \(входящее, исходящее\) и тип протокола \(IPv4, IPv6\) действует только один свой список. Поэтому списки настраиваются в как можно меньшем числе мест, например, на пограничных узлах в сеть Интернет, к чувствительным к уязвимостям доменам сети и т.д. Списки желательно размещать на роутерах таким образом, чтобы стандартные списки располагались как можно ближе к узлам назначения, а расширенные – к источникам.

Пример конфигурации стандартного списка:

```
R1(config)# access-list 10 deny host 192.168.10.5
R1(config)# access-list 10 deny 192.168.20.0 0.0.0.255 %запрещено сети 192.168.20.0 с wildcard = 0.0.0.255 (маска 255.255.255.0)
R1(config)# access-list 10 permit any
```

Здесь происходит настройка 10-го списка. Порядок ввода команд играет значительную роль, устройство проверяет поля пакета _сверху-вниз до первого совпадения_. При порядке отличном от указанного, фильтрация происходила бы некорректно, т.к. к диапазону адресов мы закрыли передачу, а потом одному из устройств из диапазона открыли – противоречие. Ключ any соответствует wildcard-mask = 255.255.255.255, когда host — 0.0.0.0.

> **Важно. ** После активации ACL, работает правило «неявного отказа» \(implicit deny\), которое блокирует весь трафик, если иное не указано в правилах этого ACL. Это и является причиной выполнения последней команды в блоке выше.

После настройки списка, необходимо применить его на интерфейсе, например:

```
R1(config)# interface s0/0/0
R1(config-if)# ip access-group 10 out %показываем принадлежность 10 списку и указываем исходящую направленность работы списка.
```

Для сброса настроек списка выполнять:

`R1(config)# no access-list 10`

Также возможно создавать именные списки, которые работают также, за исключением слегка отличающегося метода настройки:

```
R1(config)# ip access-list standard NO_ACCESS % пример имени списка, заглавными буквами для наглядности
R1(config-std-nacl)# deny host 192.168.10.5
R1(config-std-nacl)# deny 192.168.20.0 0.0.0.255
R1(config-std-nacl)# permit any
R1(config-std-nacl)# exit
R1(config)# interface s0/0/0
R1(config-if)# ip access-group NO_ACCESS out
```

Расширенные списки позволяют производить более детальную конфигурацию, например:

R1\(config\)\# access-list 101 deny tcp 192.168.11.0 0.0.0.255 192.168.10.0 0.0.0.255 eq 80

Где используется формула:`[номер списка] [название протокола (ip, tcp, udp, icmp)] [действие] [источник и wildcard-маска] [получатель и wildcard-маска] {[оператор (опционально – eq equal, neq not equal, lt less than, gr greater than)] [номер порта (опционально)]}`

Создание именных расширенных списков:

```
R1(config)# ip access-list extended NO_ACCESS
R1(config-ext-nacl)# deny tcp 192.168.11.0 0.0.0.255 192.168.10.0 0.0.0.255 eq 80
```

И затем активируются на интерфейсе, как и в предыдущем случае.

Удаление списков:

`R1(config)# ip access-list extended NO_ACCESS`

Проверку конфигураций ACLs можно производить следующими командами:

```
R1# show access-lists
R1# show ip interface
```

Типичные ошибки при конфигурации:

* неверный порядок конфигурации списков \(запись уровня хоста идёт после записи уровня той же сети\)

* неверно указан тип протокола \(TCP/UDP/ICMP/IP\) при настройке расширенного списка

* компоненты команды указаны в неверном порядке

* указаны ошибочные адреса сети \(хоста\)

* указано неверное направление фильтрации \(in/out\)

**Задание**

1. Используя таблицу адресации и топологию из предыдущих работ, выполнить:

   1) Настроить стандартный список на R2, где коммуникации с сетью 172.10.1.0/25 разрешены только сетям 172.10.1.128/25 и 192.168.20.0/24. Интерфейс для списка и направление применения выбрать самостоятельно. Убедиться в работоспособности данной конфигурации.

   2) Настроить расширенный именной список Limit\_SSH\_to\_S1 на R1, где подключаться по SSH к S1 могут только PC1 и PC7. Интерфейс для списка и направление применения выбрать самостоятельно. Убедиться в работоспособности сети.

2. Сделать выводы.
